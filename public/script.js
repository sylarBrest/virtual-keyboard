(()=>{"use strict";console.log("Virtual Keyboard task started");const e=new class{constructor(){this.elements={main:null,textarea:null,keyboardContainer:null,keys:[]},this.properties={value:"",isCapsLock:!1,isShiftPressed:!1,lang:"en",cursorPosition:0}}init(){this.elements.main=document.createElement("main"),this.elements.main.classList.add("main"),this.elements.main.classList.add("main-container"),this.elements.textarea=document.createElement("textarea"),this.elements.textarea.classList.add("textarea"),this.elements.textarea.setAttribute("autofocus","autofocus"),this.elements.textarea.setAttribute("rows","10"),this.elements.keyboardContainer=document.createElement("div"),this.elements.keyboardContainer.classList.add("keyboard"),this.elements.keys=this.elements.keyboardContainer.querySelectorAll(".key"),this.render()}createKeys(){const e=document.createDocumentFragment(),t=e=>`<span class="material-icons">${e}</span>`;return["backtick","1","2","3","4","5","6","7","8","9","0","-","=","backspace","tab","q","w","e","r","t","y","u","i","o","p","[","]","\\","del","capslock","a","s","d","f","g","h","j","k","l",";","'","enter","leftshift","z","x","c","v","b","n","m",",",".","/","uparrow","rightshift","leftctrl","win","leftalt","spacebar","rightalt","leftarrow","downarrow","rightarrow","rightctrl"].forEach((s=>{const a=document.createElement("button");let n;switch(a.setAttribute("type","button"),a.classList.add("key"),s){case"del":a.classList.add("text"),a.innerHTML="del",a.addEventListener("click",(()=>this.delClick(n)));break;case"leftctrl":case"rightctrl":a.classList.add("text"),a.textContent="ctrl";break;case"leftalt":case"rightalt":a.classList.add("text"),a.textContent="alt";break;case"backtick":a.classList.add("symbol"),[a.textContent,n]=["`","`"];break;case"tab":[a.innerHTML,n]=[t("keyboard_tab"),"\t"];break;case"win":a.innerHTML=t("window");break;case"uparrow":a.innerHTML=t("keyboard_arrow_up");break;case"leftarrow":a.innerHTML=t("keyboard_arrow_left");break;case"downarrow":a.innerHTML=t("keyboard_arrow_down");break;case"rightarrow":a.innerHTML=t("keyboard_arrow_right");break;case"backspace":a.classList.add("wide"),a.innerHTML=t("keyboard_backspace"),a.addEventListener("click",(()=>this.backspaceClick(n)));break;case"capslock":a.classList.add("wide"),a.innerHTML=t("keyboard_capslock"),a.addEventListener("click",(()=>{a.classList.toggle("pressed"),this.capsLockOn()}));break;case"enter":a.classList.add("wide"),[a.innerHTML,n]=[t("keyboard_return"),"\n"];break;case"leftshift":case"rightshift":a.classList.add("wide"),a.innerHTML=t("publish"),a.addEventListener("click",(()=>this.shiftKeyOn()));break;case"spacebar":a.classList.add("ultrawide"),[a.innerHTML,n]=[t("space_bar")," "];break;default:a.classList.add("symbol"),[n,a.innerHTML]=[s,s]}a.addEventListener("click",(()=>this.mouseClick(n))),e.append(a)})),e}mouseClick(e=""){const t=this.properties.isCapsLock?e.toUpperCase():e,s=this.elements.textarea;s.selectionEnd>=0&&s.setRangeText(t,s.selectionStart,s.selectionEnd),this.elements.textarea.focus(),this.elements.textarea.selectionStart=s.selectionEnd+1}delClick(){const e=this.elements.textarea;e.setRangeText("",e.selectionStart,e.selectionEnd+1),e.selectionEnd-=1}backspaceClick(){const e=this.elements.textarea,t=e.selectionStart-1;console.log("222",t,e.selectionEnd),t>=0&&e.setRangeText("",t,e.selectionEnd),e.selectionEnd-=1}capsLockOn(){this.properties.isCapsLock=!this.properties.isCapsLock,this.elements.keyboardContainer.querySelectorAll(".symbol").forEach((e=>{const t=e;t.textContent=this.properties.isCapsLock?t.textContent.toUpperCase():t.textContent.toLowerCase()}))}shiftKeyOn(){this.properties.isShiftPressed=!this.properties.isShiftPressed,console.log(this.properties.isShiftPressed)}render(){document.body.prepend(this.elements.main),this.elements.main.appendChild(this.elements.textarea),this.elements.main.appendChild(this.elements.keyboardContainer),this.elements.keyboardContainer.appendChild(this.createKeys())}toString(){return this.properties}};e.init(),console.log(e.toString())})();